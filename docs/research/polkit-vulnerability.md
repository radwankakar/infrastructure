# Qualys [CVE-2021-4034 Vulnerability](https://access.redhat.com/security/cve/CVE-2021-4034) Assessment

## Context:
Qualys detected a polkit vulnerability in many of our servers. This is a 12 year vulnerability tracked under [CVE-2021-4034 (Centos)](https://access.redhat.com/security/cve/CVE-2021-4034) and [USN-5252-1 (Ubuntu)](https://ubuntu.com/security/notices/USN-5252-1). Qualys did not report on the Ubuntu vulnerability though it is still an issue. This vulnerability allows any unprivileged user to gain full root privileges on a vulnerable Linux machine.

## Vulnerability Evaluation
There are two areas of risk we need to consider:
1) Users within an organization without privileges can get root privileges 
2) Outside threat - if an attacker gains user access they could exploit the vulnerability

## Resolution
This vulnerability should be patched promptly since it is a privilege escalation vulnerability, though not necessarily an immediate emergency given our protections in place (ex. Necessity to be connected to VPN to ssh into any server). The resolution includes updating the polkit / policykit-1 version on each affected server to the most recent version. Since we update all packages in our monthly maintenance, this vulnerability should be resolved as part of our normal maintenance actions. 

## Investigation
Verify polkit / policykit-1 existence and versions on all machines. Once this is done, a JIRA ticket with instructions on how to proceed will need to be created. We should also verify and note down the following information on each affected server:

* Is polkit / policykit-1 installed?
* If so, what version of polkit / policykit-1 is currently installed?

We created an ansible playbook to automate the above checks on all hosts. We had to create two seperate tasks to check this, one for centos hosts and another for ubuntu hosts. We can use this playbook to run another check on whether the vulnerability is resolved or not after the monthly maintenance changes. 

# Helpful Commands

* Check polkit version (centos) - `yum info polkit` or `rpm -q polkit`
* Check policykit-1 version (ubuntu) - `apt list -a policykit-1`

# Links and Resources

* https://www.thesecmaster.com/how-to-fix-the-polkit-privilege-escalation-vulnerability-cve-2021-4034/#
* https://access.redhat.com/security/vulnerabilities/RHSB-2022-001
* https://www.tenable.com/plugins/nessus/157138
* https://lists.centos.org/pipermail/centos-announce/2022-January/073552.html
